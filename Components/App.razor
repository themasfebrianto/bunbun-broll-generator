<!DOCTYPE html>
<html lang="en" class="dark">
<!-- Theme initialization - MUST run synchronously before any content to prevent flash -->
<script>
    (function() {
        try {
            var t = localStorage.getItem('theme');
            if (t === 'light') {
                document.documentElement.classList.remove('dark');
                document.documentElement.style.colorScheme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                document.documentElement.style.colorScheme = 'dark';
            }
        } catch (e) {
            document.documentElement.classList.add('dark');
            document.documentElement.style.colorScheme = 'dark';
        }
    })();
</script>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <title>Bunbun B-Roll Generator</title>
    
    <!-- Google Fonts: Inter + JetBrains Mono -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          container: {
            center: true,
            padding: "2rem",
            screens: { "2xl": "1400px" },
          },
          extend: {
            colors: {
              border: "hsl(var(--border))",
              input: "hsl(var(--input))",
              ring: "hsl(var(--ring))",
              background: "hsl(var(--background))",
              foreground: "hsl(var(--foreground))",
              primary: {
                DEFAULT: "hsl(var(--primary))",
                foreground: "hsl(var(--primary-foreground))",
              },
              secondary: {
                DEFAULT: "hsl(var(--secondary))",
                foreground: "hsl(var(--secondary-foreground))",
              },
              destructive: {
                DEFAULT: "hsl(var(--destructive))",
                foreground: "hsl(var(--destructive-foreground))",
              },
              success: {
                DEFAULT: "hsl(var(--success))",
                foreground: "hsl(var(--success-foreground))",
              },
              warning: {
                DEFAULT: "hsl(var(--warning))",
                foreground: "hsl(var(--warning-foreground))",
              },
              muted: {
                DEFAULT: "hsl(var(--muted))",
                foreground: "hsl(var(--muted-foreground))",
              },
              accent: {
                DEFAULT: "hsl(var(--accent))",
                foreground: "hsl(var(--accent-foreground))",
              },
              popover: {
                DEFAULT: "hsl(var(--popover))",
                foreground: "hsl(var(--popover-foreground))",
              },
              card: {
                DEFAULT: "hsl(var(--card))",
                foreground: "hsl(var(--card-foreground))",
              },
            },
            borderRadius: {
              lg: "var(--radius)",
              md: "calc(var(--radius) - 2px)",
              sm: "calc(var(--radius) - 4px)",
            },
            fontFamily: {
              sans: ["Inter", "-apple-system", "BlinkMacSystemFont", "Segoe UI", "sans-serif"],
              mono: ["JetBrains Mono", "Fira Code", "monospace"],
            },
          },
        },
      }
    </script>
    
    <!-- Theme functions for Blazor interop -->
    <script>
        window.toggleTheme = function() {
            var isDark = document.documentElement.classList.toggle('dark');
            document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';
            try {
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            } catch (e) {}
            return isDark;
        };

        window.getTheme = function() {
            return document.documentElement.classList.contains('dark') ? 'dark' : 'light';
        };
    </script>
    
    <!-- Custom Styles - Must use text/tailwindcss for @layer and @apply directives -->
    <style type="text/tailwindcss">
      @@layer base {
        /* Vercel-Style Light Mode - Clean & Minimal */
        :root {
          --background: 0 0% 100%;
          --foreground: 0 0% 0%;
          --card: 0 0% 100%;
          --card-foreground: 0 0% 0%;
          --popover: 0 0% 100%;
          --popover-foreground: 0 0% 0%;
          --primary: 0 0% 9%;
          --primary-foreground: 0 0% 100%;
          --secondary: 0 0% 96%;
          --secondary-foreground: 0 0% 9%;
          --muted: 0 0% 96%;
          --muted-foreground: 0 0% 45%;
          --accent: 0 0% 96%;
          --accent-foreground: 0 0% 9%;
          --destructive: 0 84% 60%;
          --destructive-foreground: 0 0% 100%;
          --success: 142 76% 36%;
          --success-foreground: 0 0% 100%;
          --border: 0 0% 90%;
          --input: 0 0% 90%;
          --ring: 0 0% 9%;
          --radius: 0.5rem;
          --warning: 38 92% 50%;
          --warning-foreground: 0 0% 0%;
        }
        
        /* Vercel-Style Dark Mode - Pure Black */
        .dark {
          --background: 0 0% 0%;
          --foreground: 0 0% 100%;
          --card: 0 0% 7%;
          --card-foreground: 0 0% 100%;
          --popover: 0 0% 7%;
          --popover-foreground: 0 0% 100%;
          --primary: 0 0% 100%;
          --primary-foreground: 0 0% 0%;
          --secondary: 0 0% 12%;
          --secondary-foreground: 0 0% 100%;
          --muted: 0 0% 12%;
          --muted-foreground: 0 0% 65%;
          --accent: 0 0% 12%;
          --accent-foreground: 0 0% 100%;
          --destructive: 0 62% 30%;
          --destructive-foreground: 0 0% 100%;
          --success: 142 70% 45%;
          --success-foreground: 0 0% 100%;
          --border: 0 0% 18%;
          --input: 0 0% 18%;
          --ring: 0 0% 83%;
          --warning: 38 92% 50%;
          --warning-foreground: 0 0% 0%;
        }
      }

      @@layer components {
        /* Vercel-style header - solid bg, 1px border */
        .app-header {
          @@apply sticky top-0 z-50 w-full border-b border-border bg-background;
        }
        .header-content {
          @@apply container flex h-16 items-center justify-between;
        }
        .logo {
          @@apply flex items-center gap-2 font-semibold tracking-tight text-foreground transition-opacity hover:opacity-70;
        }
        .nav-links {
          @@apply flex items-center gap-6 text-sm;
        }
        .nav-link {
          @@apply text-muted-foreground transition-colors duration-150 hover:text-foreground;
        }
        .nav-link.active {
          @@apply text-foreground font-medium;
        }
        .app-footer {
          @@apply border-t border-border py-6 md:px-8 md:py-0;
        }
        .footer-content {
          @@apply container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row;
        }
        
        /* Vercel-style buttons */
        .btn-primary {
          @@apply inline-flex items-center justify-center rounded-lg text-sm font-medium 
                 bg-primary text-primary-foreground h-10 px-4
                 transition-opacity duration-150 hover:opacity-90
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
                 disabled:pointer-events-none disabled:opacity-50;
        }
        .btn-secondary {
          @@apply inline-flex items-center justify-center rounded-lg text-sm font-medium 
                 bg-transparent text-foreground border border-border h-10 px-4
                 transition-colors duration-150 hover:bg-muted hover:border-foreground/20
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
                 disabled:pointer-events-none disabled:opacity-50;
        }
        .btn-ghost {
          @@apply inline-flex items-center justify-center rounded-lg text-sm font-medium 
                 bg-transparent text-foreground h-10 px-4
                 transition-colors duration-150 hover:bg-muted
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
                 disabled:pointer-events-none disabled:opacity-50;
        }
        .btn-destructive {
          @@apply inline-flex items-center justify-center rounded-lg text-sm font-medium 
                 bg-destructive text-destructive-foreground h-10 px-4
                 transition-opacity duration-150 hover:opacity-90
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-destructive focus-visible:ring-offset-2
                 disabled:pointer-events-none disabled:opacity-50;
        }
        
        /* Vercel-style cards - 1px border, no shadow */
        .card {
          @@apply rounded-lg border border-border bg-card text-card-foreground
                 transition-colors duration-150;
        }
        .card-hover {
          @@apply hover:border-foreground/20;
        }
        
        /* Vercel-style inputs */
        .input {
          @@apply flex h-10 w-full rounded-lg border border-border bg-transparent px-3 py-2 text-sm
                 transition-colors duration-150
                 placeholder:text-muted-foreground
                 hover:border-foreground/30
                 focus:outline-none focus:border-foreground
                 disabled:cursor-not-allowed disabled:opacity-50;
        }

        select.input {
          @@apply appearance-none bg-no-repeat pr-10 cursor-pointer;
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 0.5rem center;
          background-size: 1.5em 1.5em;
          color-scheme: light;
        }

        .dark select.input {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
          color-scheme: dark;
        }

        select.input option {
          background-color: hsl(var(--card));
          color: hsl(var(--foreground));
        }
        
        /* Vercel-style badges */
        .badge {
          @@apply inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium
                 bg-muted text-muted-foreground;
        }
        .badge-mono {
          @@apply font-mono text-[11px] tracking-tight;
        }
        
        /* Toast container */
        .toast-container {
          @@apply fixed bottom-4 right-4 z-[100] flex flex-col gap-2;
        }
        .toast {
          @@apply flex items-center gap-3 rounded-lg border border-border bg-card px-4 py-3 text-sm shadow-lg
                 animate-in slide-in-from-bottom-2;
        }
        .toast-success {
          @@apply border-success/30 bg-success/10 text-success;
        }
        .toast-error {
          @@apply border-destructive/30 bg-destructive/10 text-destructive;
        }
        
        /* Modal/Dialog */
        .modal-backdrop {
          @@apply fixed inset-0 z-50 bg-background/80 backdrop-blur-sm;
        }
        .modal {
          @@apply fixed left-1/2 top-1/2 z-50 w-full max-w-md -translate-x-1/2 -translate-y-1/2
                 rounded-lg border border-border bg-card p-6 shadow-lg;
        }

        /* Breadcrumb */
        .breadcrumb {
          @@apply flex items-center gap-2 text-sm;
        }
        .breadcrumb-item {
          @@apply flex items-center gap-1.5 text-muted-foreground hover:text-foreground transition-colors;
        }
        .breadcrumb-sep {
          @@apply text-muted-foreground;
        }
        .breadcrumb-current {
          @@apply font-medium text-foreground;
        }

        /* Progress bar */
        .progress-container {
          @@apply w-full h-2 bg-muted rounded-full overflow-hidden;
        }
        .progress-bar {
          @@apply h-full bg-primary transition-all duration-300 ease-out rounded-full;
        }

        /* Skeleton loading */
        .skeleton {
          @@apply animate-pulse bg-muted;
        }
      }
      
      @@layer utilities {
        /* Animations */
        .animate-in {
          animation: fadeIn 0.2s ease;
        }
        .slide-in-from-bottom-2 {
          animation: slideInFromBottom 0.2s ease;
        }
        .slide-in-from-top-2 {
          animation: slideInFromTop 0.2s ease;
        }
        
        @@keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @@keyframes slideInFromBottom {
          from { opacity: 0; transform: translateY(8px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @@keyframes slideInFromTop {
          from { opacity: 0; transform: translateY(-8px); }
          to { opacity: 1; transform: translateY(0); }
        }
      }
    </style>
    
    <!-- JSZip for client-side ZIP creation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- App Styles -->
    <link rel="stylesheet" href="/app.css" />
    <link rel="stylesheet" href="BunbunBroll.styles.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <HeadOutlet />
</head>

<body class="bg-background text-foreground antialiased font-sans">
    <Routes />
    <script src="/app.js"></script>
    <script src="_framework/blazor.web.js" autostart="false"></script>
    <script src="/js/blazor-reconnect.js"></script>
</body>

</html>
