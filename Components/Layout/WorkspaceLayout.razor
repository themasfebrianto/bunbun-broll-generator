@inherits LayoutComponentBase
@layout MainLayout

<div class="flex flex-col h-full h-screen overflow-hidden">
    <!-- Top Area: Project Navigation / Stepper -->
    <div class="flex-none border-b border-border bg-card/50 px-4 py-3 sticky top-0 z-10 backdrop-blur-sm">
        @if (!string.IsNullOrEmpty(ProjectId))
        {
            <ProjectStepper ProjectId="@ProjectId" CurrentStage="@CurrentStage" />
        }
        else
        {
            <div class="h-6 animate-pulse bg-muted rounded w-1/3"></div>
        }
    </div>

    <!-- Scrollable Workspace Area -->
    <div class="flex-1 overflow-y-auto p-4 md:p-6 pb-24 relative">
        <CascadingValue Value="this">
            @Body
        </CascadingValue>
    </div>
</div>

@code {
    public string ProjectId { get; set; } = string.Empty;
    public string CurrentStage { get; set; } = string.Empty;

    public void SetContext(string projectId, string stage)
    {
        ProjectId = projectId;
        CurrentStage = stage;
        StateHasChanged();
    }
}
